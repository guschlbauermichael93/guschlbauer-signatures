version: '3.8'

# Lokale Entwicklung - ohne SSL, mit Hot Reload

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile.dev
    container_name: guschlbauer-signatures-dev
    environment:
      - NODE_ENV=development
      - DATABASE_URL=file:/data/signatures.db
      - DEV_MODE=true
      - NEXT_PUBLIC_APP_URL=http://localhost:3000
      # Azure AD optional f√ºr lokale Entwicklung
      - AZURE_AD_CLIENT_ID=${AZURE_AD_CLIENT_ID:-}
      - AZURE_AD_CLIENT_SECRET=${AZURE_AD_CLIENT_SECRET:-}
      - AZURE_AD_TENANT_ID=${AZURE_AD_TENANT_ID:-}
      - NEXT_PUBLIC_AZURE_AD_CLIENT_ID=${AZURE_AD_CLIENT_ID:-}
      - NEXT_PUBLIC_AZURE_AD_TENANT_ID=${AZURE_AD_TENANT_ID:-}
    volumes:
      - ./apps/admin:/app/apps/admin
      - ./packages:/app/packages
      - app-data:/data
      - uploads:/app/uploads
      # Node modules nicht mounten (Performance)
      - /app/apps/admin/node_modules
      - /app/node_modules
    ports:
      - "3000:3000"
    command: npm run dev:admin

volumes:
  app-data:
  uploads:
